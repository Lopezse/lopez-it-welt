{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projekte/lopez-it-welt/src/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\";\n\n/**\n * Zentrale MySQL-Datenbankverbindung mit UTF-8 Konfiguration\n * Enterprise++ Standard f√ºr alle API-Routen\n *\n * @author Ramiro Lopez Rodriguez\n * @version 1.0.0\n * @date 2025-09-28\n */\n\n// MySQL-Verbindungskonfiguration - MySQL2-kompatibel\nconst dbConfig = {\n  host: \"localhost\",\n  user: \"root\",\n  password: \"\",\n  database: \"lopez_it_welt\",\n  port: 3306,\n  charset: \"utf8mb4\",\n  supportBigNumbers: true,\n  bigNumberStrings: true,\n  // MySQL2-spezifische Pool-Optionen\n  waitForConnections: true,\n  connectionLimit: 10,\n  queueLimit: 0,\n  acquireTimeout: 60000,\n  timeout: 60000,\n};\n\n// Verbindungspool f√ºr bessere Performance\nlet pool: mysql.Pool | null = null;\n\n/**\n * Erstellt oder gibt bestehenden Verbindungspool zur√ºck\n */\nexport function getConnectionPool(): mysql.Pool {\n  if (!pool) {\n    pool = mysql.createPool({\n      host: \"localhost\",\n      user: \"root\",\n      password: \"\",\n      database: \"lopez_it_welt\",\n      port: 3306,\n      charset: \"utf8mb4\",\n      supportBigNumbers: true,\n      bigNumberStrings: true,\n      // Pool-spezifische Konfiguration (nur g√ºltige Optionen)\n      waitForConnections: true,\n      connectionLimit: 10,\n      queueLimit: 0,\n    });\n  }\n  return pool;\n}\n\n/**\n * Erstellt eine neue Datenbankverbindung mit UTF-8 Konfiguration\n */\nexport async function createConnection(): Promise<mysql.Connection> {\n  try {\n    const connection = await mysql.createConnection(dbConfig);\n\n    // UTF-8 explizit setzen f√ºr maximale Kompatibilit√§t\n    await connection.execute(\"SET NAMES utf8mb4\");\n    await connection.execute(\"SET CHARACTER SET utf8mb4\");\n    await connection.execute(\"SET character_set_connection=utf8mb4\");\n    await connection.execute(\"SET character_set_results=utf8mb4\");\n    await connection.execute(\"SET character_set_client=utf8mb4\");\n\n    return connection;\n  } catch (error) {\n    console.error(\"‚ùå MySQL-Verbindung fehlgeschlagen:\", error);\n    throw new Error(\n      `Datenbankverbindung fehlgeschlagen: ${error instanceof Error ? error.message : \"Unbekannter Fehler\"}`,\n    );\n  }\n}\n\n/**\n * F√ºhrt eine Query mit UTF-8 Konfiguration aus\n */\nexport async function executeQuery<T = any>(sql: string, params: any[] = []): Promise<T> {\n  const connection = await createConnection();\n  try {\n    const [rows] = await connection.execute(sql, params);\n    return rows as T;\n  } finally {\n    await connection.end();\n  }\n}\n\n/**\n * F√ºhrt eine Query mit Verbindungspool aus (f√ºr h√§ufige Abfragen)\n */\nexport async function executeQueryPool<T = any>(sql: string, params: any[] = []): Promise<T> {\n  const pool = getConnectionPool();\n  const [rows] = await pool.execute(sql, params);\n  return rows as T;\n}\n\n/**\n * Schlie√üt den Verbindungspool (beim Herunterfahren)\n */\nexport async function closePool(): Promise<void> {\n  if (pool) {\n    await pool.end();\n    pool = null;\n  }\n}\n\n/**\n * Testet die Datenbankverbindung\n */\nexport async function testConnection(): Promise<boolean> {\n  try {\n    const connection = await createConnection();\n    await connection.execute(\"SELECT 1\");\n    await connection.end();\n    return true;\n  } catch (error) {\n    console.error(\"‚ùå Datenbankverbindung fehlgeschlagen:\", error);\n    return false;\n  }\n}\n\n/**\n * Pr√ºft UTF-8 Konfiguration der Datenbank\n */\nexport async function checkUTF8Config(): Promise<{\n  database: string;\n  server: string;\n  connection: string;\n  results: string;\n}> {\n  const connection = await createConnection();\n  try {\n    const [rows] = await connection.execute(`\n      SELECT \n        @@character_set_database as database,\n        @@character_set_server as server,\n        @@character_set_connection as connection,\n        @@character_set_results as results\n    `);\n\n    const result = (rows as any[])[0];\n    await connection.end();\n\n    return {\n      database: result.database,\n      server: result.server,\n      connection: result.connection,\n      results: result.results,\n    };\n  } catch (error) {\n    await connection.end();\n    throw error;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;AAEA;;;;;;;CAOC,GAED,qDAAqD;AACrD,MAAM,WAAW;IACf,MAAM;IACN,MAAM;IACN,UAAU;IACV,UAAU;IACV,MAAM;IACN,SAAS;IACT,mBAAmB;IACnB,kBAAkB;IAClB,mCAAmC;IACnC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,gBAAgB;IAChB,SAAS;AACX;AAEA,0CAA0C;AAC1C,IAAI,OAA0B;AAKvB,SAAS;IACd,IAAI,CAAC,MAAM;QACT,OAAO,8IAAK,CAAC,UAAU,CAAC;YACtB,MAAM;YACN,MAAM;YACN,UAAU;YACV,UAAU;YACV,MAAM;YACN,SAAS;YACT,mBAAmB;YACnB,kBAAkB;YAClB,wDAAwD;YACxD,oBAAoB;YACpB,iBAAiB;YACjB,YAAY;QACd;IACF;IACA,OAAO;AACT;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM,8IAAK,CAAC,gBAAgB,CAAC;QAEhD,oDAAoD;QACpD,MAAM,WAAW,OAAO,CAAC;QACzB,MAAM,WAAW,OAAO,CAAC;QACzB,MAAM,WAAW,OAAO,CAAC;QACzB,MAAM,WAAW,OAAO,CAAC;QACzB,MAAM,WAAW,OAAO,CAAC;QAEzB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sCAAsC;QACpD,MAAM,IAAI,MACR,CAAC,oCAAoC,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,sBAAsB;IAE1G;AACF;AAKO,eAAe,aAAsB,GAAW,EAAE,SAAgB,EAAE;IACzE,MAAM,aAAa,MAAM;IACzB,IAAI;QACF,MAAM,CAAC,KAAK,GAAG,MAAM,WAAW,OAAO,CAAC,KAAK;QAC7C,OAAO;IACT,SAAU;QACR,MAAM,WAAW,GAAG;IACtB;AACF;AAKO,eAAe,iBAA0B,GAAW,EAAE,SAAgB,EAAE;IAC7E,MAAM,OAAO;IACb,MAAM,CAAC,KAAK,GAAG,MAAM,KAAK,OAAO,CAAC,KAAK;IACvC,OAAO;AACT;AAKO,eAAe;IACpB,IAAI,MAAM;QACR,MAAM,KAAK,GAAG;QACd,OAAO;IACT;AACF;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM;QACzB,MAAM,WAAW,OAAO,CAAC;QACzB,MAAM,WAAW,GAAG;QACpB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yCAAyC;QACvD,OAAO;IACT;AACF;AAKO,eAAe;IAMpB,MAAM,aAAa,MAAM;IACzB,IAAI;QACF,MAAM,CAAC,KAAK,GAAG,MAAM,WAAW,OAAO,CAAC,CAAC;;;;;;IAMzC,CAAC;QAED,MAAM,SAAS,AAAC,IAAc,CAAC,EAAE;QACjC,MAAM,WAAW,GAAG;QAEpB,OAAO;YACL,UAAU,OAAO,QAAQ;YACzB,QAAQ,OAAO,MAAM;YACrB,YAAY,OAAO,UAAU;YAC7B,SAAS,OAAO,OAAO;QACzB;IACF,EAAE,OAAO,OAAO;QACd,MAAM,WAAW,GAAG;QACpB,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projekte/lopez-it-welt/src/app/api/content/header/route.ts"],"sourcesContent":["import { createConnection, executeQuery } from \"@/lib/db\";\nimport { NextRequest, NextResponse } from \"next/server\";\n\n// GET - Header-Daten abrufen\nexport async function GET() {\n  try {\n    const rows = await executeQuery(\n      \"SELECT * FROM content_header WHERE is_active = TRUE ORDER BY created_at DESC LIMIT 1\",\n    );\n\n    if (Array.isArray(rows) && rows.length === 0) {\n      console.warn(\"‚ö†Ô∏è Header API: Keine aktiven Header-Daten in der Datenbank gefunden\");\n      return NextResponse.json(\n        {\n          error: \"Keine Header-Daten gefunden\",\n          dataSource: \"database\",\n          status: \"empty\",\n        },\n        { status: 404 },\n      );\n    }\n\n    // ‚úÖ ERFOLGREICH AUS DATENBANK GELADEN\n    console.log(\"‚úÖ Header API: Daten erfolgreich aus Datenbank geladen\");\n    return NextResponse.json(\n      {\n        ...rows[0],\n        dataSource: \"database\",\n        status: \"success\",\n        timestamp: new Date().toISOString(),\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json; charset=utf-8\",\n        },\n      },\n    );\n  } catch (error) {\n    console.error(\"‚ùå Header API Fehler:\", error);\n\n    // üö® NOTFALL-FALLBACK MIT KLARER MELDUNG\n    const mockHeaderData = {\n      id: 1,\n      logo_text: \"Lopez IT Welt\",\n      logo_icon: \"LW\",\n      navigation_items: [\n        { label: \"Leistungen\", link: \"/leistungen\", type: \"link\" },\n        { label: \"Projekte\", link: \"/projekte\", type: \"link\" },\n        { label: \"Kontakt\", link: \"/kontakt\", type: \"link\" },\n      ],\n      mobile_menu_text: \"Men√º\",\n      language_switch: true,\n      is_active: true,\n      // üö® NOTFALL-METADATEN\n      dataSource: \"fallback\",\n      status: \"fallback\",\n      fallbackReason: \"Datenbank-Verbindung fehlgeschlagen\",\n      timestamp: new Date().toISOString(),\n      warning: \"‚ö†Ô∏è NOTFALL-MODUS: Daten aus Fallback-System geladen\",\n    };\n\n    console.warn(\"üö® Header API: Notfall-Modus aktiviert - Mock-Daten geladen\");\n    return NextResponse.json(mockHeaderData, {\n      headers: {\n        \"Content-Type\": \"application/json; charset=utf-8\",\n      },\n    });\n  }\n}\n\n// PUT - Header-Daten aktualisieren\nexport async function PUT(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const connection = await createConnection();\n\n    const {\n      logo_text,\n      navigation_items,\n      mobile_menu_text = \"Men√º\",\n      language_switch = true,\n      is_active = true,\n    } = body;\n\n    await connection.execute(\n      `UPDATE content_header SET \n             logo_text = ?, \n             navigation_items = ?,\n             mobile_menu_text = ?,\n             language_switch = ?,\n             is_active = ?,\n             updated_at = CURRENT_TIMESTAMP\n             WHERE id = ?`,\n      [\n        logo_text,\n        JSON.stringify(navigation_items),\n        mobile_menu_text,\n        language_switch,\n        is_active,\n        body.id,\n      ],\n    );\n\n    await connection.end();\n\n    return NextResponse.json(\n      {\n        success: true,\n        message: \"Header-Daten aktualisiert\",\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json; charset=utf-8\",\n        },\n      },\n    );\n  } catch (error) {\n    console.error(\"‚ùå Header Update Fehler:\", error);\n    return NextResponse.json(\n      {\n        error: \"Update fehlgeschlagen\",\n        details: error instanceof Error ? error.message : \"Unbekannter Fehler\",\n      },\n      { status: 500 },\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,kIAAY,EAC7B;QAGF,IAAI,MAAM,OAAO,CAAC,SAAS,KAAK,MAAM,KAAK,GAAG;YAC5C,QAAQ,IAAI,CAAC;YACb,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,YAAY;gBACZ,QAAQ;YACV,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,sCAAsC;QACtC,QAAQ,GAAG,CAAC;QACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,GAAG,IAAI,CAAC,EAAE;YACV,YAAY;YACZ,QAAQ;YACR,WAAW,IAAI,OAAO,WAAW;QACnC,GACA;YACE,SAAS;gBACP,gBAAgB;YAClB;QACF;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QAEtC,yCAAyC;QACzC,MAAM,iBAAiB;YACrB,IAAI;YACJ,WAAW;YACX,WAAW;YACX,kBAAkB;gBAChB;oBAAE,OAAO;oBAAc,MAAM;oBAAe,MAAM;gBAAO;gBACzD;oBAAE,OAAO;oBAAY,MAAM;oBAAa,MAAM;gBAAO;gBACrD;oBAAE,OAAO;oBAAW,MAAM;oBAAY,MAAM;gBAAO;aACpD;YACD,kBAAkB;YAClB,iBAAiB;YACjB,WAAW;YACX,uBAAuB;YACvB,YAAY;YACZ,QAAQ;YACR,gBAAgB;YAChB,WAAW,IAAI,OAAO,WAAW;YACjC,SAAS;QACX;QAEA,QAAQ,IAAI,CAAC;QACb,OAAO,gJAAY,CAAC,IAAI,CAAC,gBAAgB;YACvC,SAAS;gBACP,gBAAgB;YAClB;QACF;IACF;AACF;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,aAAa,MAAM,IAAA,sIAAgB;QAEzC,MAAM,EACJ,SAAS,EACT,gBAAgB,EAChB,mBAAmB,MAAM,EACzB,kBAAkB,IAAI,EACtB,YAAY,IAAI,EACjB,GAAG;QAEJ,MAAM,WAAW,OAAO,CACtB,CAAC;;;;;;;yBAOkB,CAAC,EACpB;YACE;YACA,KAAK,SAAS,CAAC;YACf;YACA;YACA;YACA,KAAK,EAAE;SACR;QAGH,MAAM,WAAW,GAAG;QAEpB,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,SAAS;QACX,GACA;YACE,SAAS;gBACP,gBAAgB;YAClB;QACF;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}